<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>福</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Liu+Jian+Mao+Cao&family=Ma+Shan+Zheng&family=Zhi+Mang+Xing&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap">
    <!-- Chinese Webfont Project — calligraphy fonts (subset on demand via unicode-range) -->
    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/cezkzdbs@3.0.0/dist/%E4%BB%93%E8%80%B3%E5%91%A8%E7%8F%82%E6%AD%A3%E5%A4%A7%E6%A6%9C%E4%B9%A6/result.css">
    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/hlxsjt@3.0.0/dist/%E9%B8%BF%E9%9B%B7%E8%A1%8C%E4%B9%A6%E7%AE%80%E4%BD%93/result.css">
    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/qtbfsxt@3.0.0/dist/%E5%8D%83%E5%9B%BE%E7%AC%94%E9%94%8B%E6%89%8B%E5%86%99%E4%BD%93/result.css">

    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/ysbzt@3.0.0/dist/%E5%B3%84%E5%B1%B1%E7%A2%91%E7%AF%86%E4%BD%93/result.css">
    <link rel="stylesheet" href="./envelope.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #CC0000;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            font-family: 'Courier New', 'SF Mono', monospace;
        }

        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
    <canvas id="c"></canvas>

    <!-- Red Envelope UI Overlay -->
    <div id="envelope-overlay">
        <div id="envelope-panel" class="envelope-panel">

            <!-- Header -->
            <h1>福</h1>
            <div id="piece-badge-slot"></div>

            <!-- Wish history -->
            <div class="wish-timeline">
                <div class="wish-timeline-title">Wishes <span class="timeline-title-cn">祈愿录</span></div>
                <div id="wish-timeline-list"></div>
            </div>

            <!-- Wish input (shown when not sealed) -->
            <div id="section-wish" class="panel-section">
                <div class="section-divider"></div>
                <textarea id="wish-input" rows="3" placeholder="Write your wish..."></textarea>
                <button id="btn-submit-wish" class="ceremonial-btn">
                    <span class="btn-seal-icon">印</span>
                    <span class="btn-seal-text">Seal Wish</span>
                </button>
                <div id="seal-error" class="unseal-error"></div>
            </div>

            <!-- Challenge gate (shown when piece is sealed by someone else) -->
            <div id="section-challenge" class="panel-section" style="display:none">
                <div class="section-divider"></div>
                <p class="challenge-prompt">This wish is sealed. Enter it to unlock.</p>
                <div class="challenge-section">
                    <input id="challenge-input" type="text" placeholder="Enter the sealed wish..." />
                    <div id="challenge-error" class="unseal-error"></div>
                </div>
                <button id="btn-challenge-submit" class="ceremonial-btn">
                    <span class="btn-seal-icon">解</span>
                    <span class="btn-seal-text">Verify &amp; Unseal</span>
                </button>
            </div>

            <!-- Sealed info (shown after sealing) -->
            <div id="section-sealed" class="panel-section" style="display:none">
                <div class="section-divider"></div>
                <div id="btc-button" class="btc-button" title="Tap to reveal address">
                    <div class="btc-button-front">
                        <div class="btc-icon">₿</div>
                        <span>This envelope holds Bitcoin</span>
                    </div>
                    <div class="btc-button-back">
                        <div class="btc-address-label">WALLET ADDRESS</div>
                        <div id="btc-address" class="btc-address"></div>
                    </div>
                </div>

                <button id="btn-golden-finger" class="golden-finger-btn" style="display:none;">
                    金手指 — CLAIM FORTUNE DRAWS
                </button>

                <button id="btn-unseal" class="ceremonial-btn">
                    <span class="btn-seal-icon">启</span>
                    <span class="btn-seal-text">Unseal &amp; Pass On</span>
                </button>

                <!-- Inline unseal form (expands on click) -->
                <div id="unseal-area" style="display:none">
                    <div class="unseal-section">
                        <input id="unseal-input" type="text" placeholder="Re-enter your wish to unseal..." />
                        <div id="unseal-error" class="unseal-error"></div>
                    </div>
                    <button id="btn-confirm-unseal" class="ceremonial-btn">
                        <span class="btn-seal-icon">启</span>
                        <span class="btn-seal-text">Confirm Unseal</span>
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script type="module" src="./fu.js"></script>
</body>
</html>
