<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cool Fireworks</title>
  <style>
    /* Basic reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: black;
      overflow: hidden;    /* Hide scrollbars */
      font-family: monospace;
      width: 100vw;        /* Fill entire viewport width */
      height: 100vh;       /* Fill entire viewport height */
      position: relative;  /* So absolute sparks position relative to body */
    }
    .spark {
      position: absolute;
      color: white;
      pointer-events: none; /* clicks pass through sparks */
      opacity: 1;           /* we'll animate this out in JS */
    }
  </style>
</head>
<body>

<script>
/* 
  This script spawns "rockets" from the bottom.
  Each rocket travels up with a bit of randomness. 
  After some time (or once its velocity starts going downward),
  it explodes into sparks. 
  Each spark has velocity, gravity, fade-out (opacity), and a color glow.

  ADJUSTABLE PARAMETERS are near the top (GRAVITY, rocket speeds, spark speeds, etc.).
*/

/* ==== CONFIG / GLOBALS ==== */
const GRAVITY = 0.03;       // Lower gravity so sparks fall more slowly
const ROCKET_SPEED = -5;    // How fast rockets shoot up
const ROCKET_INTERVAL = 2000; // Interval between rockets launching (ms)

// Smaller bursts, slower speed
const SPARK_COUNT_MIN = 15;  
const SPARK_COUNT_MAX = 25;  

const SPARK_SPEED_MIN = 1;    // Slower minimal speed 
const SPARK_SPEED_MAX = 2.5;  // Slower maximum speed

// Opacity fade speed (slower fade so we see the glow linger)
const SPARK_FADE_MIN = 0.004; // 0.4% per frame
const SPARK_FADE_MAX = 0.006; // 0.6% per frame

// Each spark picks from this set of multi-character strings:
const SPARK_CHAR_SET = [
  "*", "**", "+*", ".o", "✸", "※", "*+", ".*", "o*", "✨"
];
  
// Available colors
const COLORS = ["red", "yellow", "orange", "cyan", "magenta", "lime", "white"];

/* 
  We'll track rockets & sparks in arrays. 
  Each animation frame, we update positions & remove finished elements.
*/
let rockets = [];
let sparks = [];

/* ==== CLASS: Rocket ==== */
class Rocket {
  constructor() {
    // Launch somewhere near the bottom
    this.x = Math.random() * window.innerWidth;
    this.y = window.innerHeight - 5;
    // Slight horizontal velocity
    this.vx = (Math.random() - 0.5) * 1.5;
    // Upward velocity with some randomness
    this.vy = ROCKET_SPEED + Math.random() * -2;
    this.exploded = false;

    // Random explosion delay so not all explode at the same height/time
    this.explodeTime = 800 + Math.random() * 700; // 0.8 - 1.5s in the air
    this.startTime = Date.now();

    // Create DOM element for the rocket
    this.el = document.createElement("div");
    this.el.className = "spark"; 
    // Could be any ASCII rocket char
    this.el.textContent = "^";
    this.el.style.left = this.x + "px";
    this.el.style.top = this.y + "px";
    this.el.style.color = "white";    // Rockets are white
    // Optionally give rocket a subtle glow
    this.el.style.textShadow = "0 0 4px white, 0 0 8px white";

    document.body.appendChild(this.el);
  }

  update(dt) {
    // dt: time since last frame (ms)
    // We'll base our motion on dt but keep it small-scale.
    // For simplicity, scale dt down a bit so it's not too jumpy:
    const dtSec = dt * 0.06; 

    // Gravity
    this.vy += GRAVITY * dtSec;
    // Move rocket
    this.x += this.vx * dtSec;
    this.y += this.vy * dtSec;

    // Update rocket's DOM position
    this.el.style.left = this.x + "px";
    this.el.style.top = this.y + "px";

    // If rocket has been in air > explodeTime or starts falling
    if (!this.exploded && (Date.now() - this.startTime > this.explodeTime || this.vy >= 0)) {
      this.explode();
    }
  }

  explode() {
    this.exploded = true;
    // Remove rocket element
    document.body.removeChild(this.el);

    // Create sparks
    const sparkCount = SPARK_COUNT_MIN + Math.floor(Math.random() * (SPARK_COUNT_MAX - SPARK_COUNT_MIN + 1));
    for (let i = 0; i < sparkCount; i++) {
      const angle = Math.random() * Math.PI * 2;
      // random speed
      const speed = SPARK_SPEED_MIN + Math.random() * (SPARK_SPEED_MAX - SPARK_SPEED_MIN);

      const s = new Spark(this.x, this.y);
      s.vx = Math.cos(angle) * speed;
      s.vy = Math.sin(angle) * speed;
      sparks.push(s);
    }
  }
}

/* ==== CLASS: Spark ==== */
class Spark {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.vx = 0;
    this.vy = 0;
    this.alpha = 1;  // full opacity
    // random fade speed
    this.fade = SPARK_FADE_MIN + Math.random() * (SPARK_FADE_MAX - SPARK_FADE_MIN);
    // pick random color
    this.color = COLORS[Math.floor(Math.random() * COLORS.length)];
    // pick random multi-char
    const sparkStr = SPARK_CHAR_SET[Math.floor(Math.random() * SPARK_CHAR_SET.length)];

    // Create DOM element
    this.el = document.createElement("div");
    this.el.className = "spark";
    this.el.textContent = sparkStr;
    this.el.style.left = this.x + "px";
    this.el.style.top = this.y + "px";
    this.el.style.color = this.color;

    // Bloom / glow effect
    // You can add more shadow layers to make bigger glow
    this.el.style.textShadow = `0 0 6px ${this.color}, 0 0 12px ${this.color}`;

    document.body.appendChild(this.el);
  }

  update(dt) {
    const dtSec = dt * 0.06; 

    // Gravity
    this.vy += GRAVITY * 0.5 * dtSec;  // half gravity or same as rocket, up to you

    // Move
    this.x += this.vx * dtSec;
    this.y += this.vy * dtSec;

    // Fade out
    this.alpha -= this.fade * dtSec;
    if (this.alpha < 0) this.alpha = 0;

    // Update DOM
    this.el.style.left = this.x + "px";
    this.el.style.top = this.y + "px";
    this.el.style.opacity = this.alpha;

    // If fully invisible or off screen, remove it
    if (this.alpha <= 0 || this.y > window.innerHeight + 50) {
      document.body.removeChild(this.el);
      return false; // indicates spark is finished
    }
    return true; // still alive
  }
}

/* ==== ANIMATION LOOP ==== */
let lastFrameTime = performance.now();

function animate(currentTime) {
  requestAnimationFrame(animate);
  const dt = currentTime - lastFrameTime;
  lastFrameTime = currentTime;

  // Update rockets
  rockets = rockets.filter(rocket => {
    if (!rocket.exploded) {
      rocket.update(dt);
      return !rocket.exploded; 
    }
    return false; 
  });

  // Update sparks
  sparks = sparks.filter(spark => spark.update(dt));
}

/* ==== ROCKET SPAWNING ==== */
function spawnRocket() {
  rockets.push(new Rocket());
}

// Start the animation
requestAnimationFrame(animate);

// Launch a rocket periodically
setInterval(spawnRocket, ROCKET_INTERVAL);
</script>

</body>
</html>
