import{S as V,C as q,W as H,P as I,V as _,O as Y,A as X,D as Z,G as J,b as O,c as k,T as W,B as K,R as N,d as Q,e as $,L as ee,f as te,M as oe}from"./GLTFLoader-CMuw7u_6.js";import ie from"https://cdn.skypack.dev/lottie-web";const ne="varying vec3 vPosition;varying vec2 vUv;uniform float iAudioData;uniform float iScale;uniform sampler2D iOriginalColor;void main(){vUv=uv;vec3 originalColor=texture(iOriginalColor,uv).rgb;float blackness=1.0-dot(originalColor,vec3(0.333));vec3 modifiedPosition=position;if(blackness>0.8){modifiedPosition.y+=iAudioData*blackness*iScale;}vPosition=modifiedPosition;gl_Position=projectionMatrix*modelViewMatrix*vec4(modifiedPosition,1.0);}",re="uniform float iTime;uniform vec2 iResolution;uniform float iSpeed;uniform float iGridSize;uniform float iFrequency;uniform float iBrightness;uniform float iTextScale;uniform sampler2D iChannel0;uniform sampler2D iChannel1;uniform sampler2D iOriginalColor;varying vec2 vUv;float text(vec2 fragCoord){vec2 uv=mod(fragCoord.xy,iGridSize)/iGridSize;vec2 block=fragCoord.xy/iGridSize;uv=uv*(iTextScale+1.0);uv+=floor(texture(iChannel1,block/iResolution+iTime*0.002).xy*iGridSize);uv*=0.0625;uv=clamp(uv,0.0,1.0);return texture(iChannel0,uv).r;}vec3 rain(vec2 fragCoord){fragCoord.x-=mod(fragCoord.x,iGridSize);float offset=sin(fragCoord.x*iFrequency);float speed=cos(fragCoord.x*6.0)*0.3+0.7;float y=fract(fragCoord.y/iResolution.y-iTime*speed*iSpeed+offset);return vec3(0.1,1.0,0.35)/(y*iBrightness);}float edgeDetection(vec2 uv,sampler2D tex){vec2 texelSize=1.0/iResolution;float threshold=0.1;float gx=-1.0*texture(tex,uv+vec2(-texelSize.x,-texelSize.y)).r+-2.0*texture(tex,uv+vec2(-texelSize.x,0.0)).r+-1.0*texture(tex,uv+vec2(-texelSize.x,texelSize.y)).r+1.0*texture(tex,uv+vec2(texelSize.x,-texelSize.y)).r+2.0*texture(tex,uv+vec2(texelSize.x,0.0)).r+1.0*texture(tex,uv+vec2(texelSize.x,texelSize.y)).r;float gy=-1.0*texture(tex,uv+vec2(-texelSize.x,-texelSize.y)).r+-2.0*texture(tex,uv+vec2(0.0,-texelSize.y)).r+-1.0*texture(tex,uv+vec2(texelSize.x,-texelSize.y)).r+1.0*texture(tex,uv+vec2(-texelSize.x,texelSize.y)).r+2.0*texture(tex,uv+vec2(0.0,texelSize.y)).r+1.0*texture(tex,uv+vec2(texelSize.x,texelSize.y)).r;float edge=length(vec2(gx,gy));return edge>threshold ? 1.0 : 0.0;}void main(){vec2 fragCoord=vUv*iResolution;vec3 originalColor=texture(iOriginalColor,vUv).rgb;vec3 textRainEffect=text(fragCoord)*rain(fragCoord);float edge=edgeDetection(vUv,iOriginalColor);vec3 edgeColor=vec3(1.0,0.0,0.0);vec3 finalColor=mix(textRainEffect,edgeColor,edge);gl_FragColor=vec4(finalColor,1.0);}",ae="varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",se="varying vec2 vUv;void main(){gl_FragColor=vec4(0.0,0.0,0.0,1.0);}";let a,u,B,S,v,G,T,E,f,U;const c=[],le=5036,L=.01,ce=135,ue=-1,de=0,fe=0,me=.1,ve=.1,ge=20,s=new Audio("../audios/The Chainsmokers - Roses (Audio) ft. ROZES (320).mp3"),z=new AudioContext,xe=z.createMediaElementSource(s),C=z.createAnalyser();xe.connect(C);C.connect(z.destination);C.fftSize=256;const he=C.frequencyBinCount,p=new Uint8Array(he);s.autoplay=!0;s.loop=!0;s.play();let R,y;pe();Se();Ce(3,.18);ye();j();function pe(){a=new V,a.background=new q(16777215),v=new H({antialias:!0}),v.setSize(window.innerWidth,window.innerHeight),document.getElementById("threeDScene").appendChild(v.domElement),u=new I(75,window.innerWidth/window.innerHeight,.1,1e3),u.position.y=2,u.lookAt(new _(0,0,0)),B=new Y(u,v.domElement),S=.001,B.update(),G=new X(16777215,.5),a.add(G),T=new Z(16777215,1),T.position.set(5,5,5),a.add(T),document.addEventListener("mousedown",we,!1)}function ye(){R=document.getElementById("lottie-container"),y=ie.loadAnimation({container:R,renderer:"svg",loop:!0,autoplay:!1,path:"../images/eroseAudioWave.json"});function n(){requestAnimationFrame(n),s.paused?(y.pause(),S=0):y.isPaused&&y.play()}n()}function Se(){E=new J,E.load("../3DModels/3dRose.glb",function(i){f=i.scene,U=f.children[0].material;const r=U.map;f.traverse(function(e){e.isMesh&&(e.material=new O({vertexShader:ne,fragmentShader:re,uniforms:{iTime:{value:0},iSpeed:{value:.01},iResolution:{value:new k(window.innerWidth,window.innerHeight)},iGridSize:{value:8},iFrequency:{value:30},iBrightness:{value:5},iTextScale:{value:8},iChannel0:{value:new W().load("../images/rainCh1.png")},iChannel1:{value:new W().load("../images/rainCh2.png")},iOriginalColor:{value:r},iAudioData:{value:0},iScale:{value:.2},iLineDensity:{value:.2}}}))}),f.scale.set(4,4,4),a.add(f),console.log("Model loaded successfully")},void 0,function(i){console.error("Error loading model:",i)});function n(){requestAnimationFrame(n),f&&(f.rotation.y+=S,f.traverse(function(i){if(i.isMesh&&i.material.uniforms){i.material.uniforms.iTime.value+=.05,C.getByteFrequencyData(p);const r=p.reduce((e,d)=>e+d)/p.length;i.material.uniforms.iAudioData.value=r/256}}))}n()}function Ce(n,i){const r=new K(i,i,i);new q(Math.random(),Math.random(),Math.random());let e=performance.now();function d(w,t){const b=(Math.random()-.5)*ve*2;let A=new O({vertexShader:ae,fragmentShader:se}).clone();const o=new oe(r,A);if(o.position.set(0,w+b-1.5,-(t-1.5)),a.add(o),c.push(o),c.length>le){const x=c.shift();a.remove(x)}}function g(){requestAnimationFrame(g);const w=performance.now();if(C.getByteFrequencyData(p),w-e>=ge){e=w;for(let t=0;t<p.length;t+=Math.floor(p.length/(n*n)))if(p[t]>ce){const D=t%n*i,A=Math.floor(t/n)*me;d(D,A)}}c.forEach(t=>{t.position.x+=L*ue,t.position.y+=L*de,t.position.z+=L*fe});for(let t=c.length-1;t>=0;t--)(Math.abs(c[t].position.x)>10||Math.abs(c[t].position.y)>10||Math.abs(c[t].position.z)>10)&&(a.remove(c[t]),c.splice(t,1));v.render(a,u)}g()}function j(){requestAnimationFrame(j),B.update(),v.render(a,u)}window.addEventListener("resize",function(){u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),v.setSize(window.innerWidth,window.innerHeight)});function we(n){n.preventDefault();const i=new k;i.x=n.clientX/window.innerWidth*2-1,i.y=-(n.clientY/window.innerHeight)*2+1;const r=new N;r.setFromCamera(i,u);const e=r.intersectObjects(a.children,!0);if(e.length>0){const d=e[0].object;z.state==="suspended"&&z.resume().then(()=>{console.log("AudioContext resumed")}),d.parent===f&&(s.paused?(s.play(),S=.001):(S=0,s.pause(),y.goToAndStop(0,!0)))}}R.addEventListener("click",function(){s.paused?(s.play(),y.play(),S=.001,z.resume().then(()=>{console.log("AudioContext resumed")})):(s.pause(),y.goToAndStop(0,!0),S=.001)});function Ae(n,i){const r=i.fftSize,e={length:200,scale:.01,rotation:{x:0,y:0,z:0},smoothing:.001,position:{x:0,y:0,z:0}},d=new Q,g=new Float32Array(r*3);d.setAttribute("position",new $(g,3));const w=new ee({color:16711680}),t=new te(d,w);n.add(t);function b(o,x){const M=new Float32Array(o.length);for(let m=0;m<o.length;m++){let l=0,F=0;for(let h=-Math.floor(x/2);h<=Math.floor(x/2);h++)m+h>=0&&m+h<o.length&&(l+=o[m+h],F++);M[m]=l/F}return M}function D(){function o(){const M=new Uint8Array(r);i.getByteTimeDomainData(M);const m=b(M,e.smoothing);for(let l=0;l<r;l++){const F=l/r*e.length-e.length/2,h=0,P=m[l]/128*e.scale-e.scale/2;g[l*3]=F,g[l*3+1]=h,g[l*3+2]=P}d.attributes.position.needsUpdate=!0,t.position.set(e.position.x,e.position.y,e.position.z),t.rotation.set(e.rotation.x,e.rotation.y,e.rotation.z)}function x(){requestAnimationFrame(x),o(),v.render(n,u)}x()}D();function A(o){e.length=o.length!==void 0?o.length:e.length,e.scale=o.scale!==void 0?o.scale:e.scale,e.rotation=o.rotation!==void 0?o.rotation:e.rotation,e.smoothing=o.smoothing!==void 0?o.smoothing:e.smoothing,e.position=o.position!==void 0?o.position:e.position}return A({length:20,scale:1,rotation:{x:0,y:Math.PI/2,z:0},smoothing:5,position:{x:-.5,y:-.7,z:0}}),{setWaveformParams:A}}Ae(a,C);
