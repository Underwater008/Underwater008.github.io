import"./modulepreload-polyfill-B5Qt9EMX.js";import{ai as k,C as T,aD as z,E as W,aj as H,ak as K,P as O,G as Y,aE as B,aF as C,aG as I,h as A,aH as j,aI as q,x as U,q as _,az as J}from"./three.module-CAwrvc93.js";import{g as b}from"./index-DjKJqAo0.js";const w={RED:16723245,GOLD:16766720,JADE:65439,BG:657930},N="福禄寿喜财财富贵发金玉宝余丰盛利旺隆昌兴进通达安康宁泰和平顺健喜乐欢庆禧祺嘉春德善仁义忠信孝慧恩爱合圆满美馨雅吉祥瑞如意祝运龙凤麟鹤华成升登高",x=N.split("");let o,f,d,p,G=[],v=[];function V(){const n=document.getElementById("canvas-container");o=new k,o.background=new T(w.BG),o.fog=new z(w.BG,.05),f=new W(75,window.innerWidth/window.innerHeight,.1,1e3),f.position.z=30,d=new H({antialias:!0,alpha:!0}),d.setSize(window.innerWidth,window.innerHeight),d.setPixelRatio(Math.min(window.devicePixelRatio,2)),n.appendChild(d.domElement),Q();const t=new K(16777215,.5);o.add(t);const e=new O(w.RED,1,100);e.position.set(10,10,10),o.add(e),window.addEventListener("resize",Z,!1),X(),R()}function Q(){const n=document.createElement("canvas"),t=n.getContext("2d"),e=128;n.width=e,n.height=e,t.fillStyle="#000000",t.fillRect(0,0,e,e),t.font='bold 100px "Courier New", monospace',t.fillStyle="#FFFFFF",t.textAlign="center",t.textBaseline="middle",t.fillText("福",e/2,e/2);const i=t.getImageData(0,0,e,e).data;p=new Y;const a={};for(let c=0;c<e;c+=2)for(let r=0;r<e;r+=2){const h=(c*e+r)*4;if(i[h]>128){const E=(r-e/2)*.25,F=-(c-e/2)*.25,D=(Math.random()-.5)*5,g=x[Math.floor(Math.random()*x.length)];a[g]||(a[g]=P(g));const S=new B({map:a[g],color:w.RED,transparent:!0,opacity:.8,blending:C}),u=new I(S);u.position.set(E,F,D),u.scale.set(1.5,1.5,1.5),u.userData={originalPos:new A(E,F,D),speed:Math.random()*.02+.01},p.add(u),G.push(u)}}window.materialCache=a,o.add(p);const m=new j(35,35,35),y=new q(m),s=new U(y,new _({color:3355443}));o.add(s),b.to(p.rotation,{y:Math.PI*2,duration:20,repeat:-1,ease:"none"}),b.to(s.rotation,{y:Math.PI*2,duration:25,repeat:-1,ease:"none"})}function P(n){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");return e.font="bold 48px monospace",e.fillStyle="#FFFFFF",e.textAlign="center",e.textBaseline="middle",e.fillText(n,32,32),new J(t)}function M(n,t,e){for(let i=0;i<30;i++){const a=x[Math.floor(Math.random()*x.length)];let m=window.materialCache&&window.materialCache[a];m||(m=P(a));const y=new B({map:m,color:w.GOLD,transparent:!0,blending:C}),s=new I(y);s.position.set(n,t,e),s.scale.set(2,2,2);const c=Math.random()*Math.PI*2,r=Math.random()*Math.PI,h=Math.random()*.5+.5,L=new A(Math.sin(r)*Math.cos(c)*h,Math.sin(r)*Math.sin(c)*h,Math.cos(r)*h);s.userData={velocity:L,life:1},o.add(s),v.push(s)}}function X(){const n=document.getElementById("screen-arrival"),t=document.getElementById("screen-fortune"),e=document.getElementById("screen-wish"),l=document.getElementById("screen-key");n.addEventListener("click",()=>{navigator.vibrate&&navigator.vibrate(50),n.classList.add("hidden"),n.classList.remove("active"),t.classList.remove("hidden"),t.classList.add("active");const i=document.getElementById("fortune-main");i.innerText="Drawing...",setTimeout(()=>{i.innerText="大吉",document.getElementById("fortune-sub").innerText="Great Fortune. Your path is clear.",navigator.vibrate&&navigator.vibrate([100,50,100]);for(let a=0;a<5;a++)setTimeout(()=>{M((Math.random()-.5)*20,(Math.random()-.5)*20,(Math.random()-.5)*10)},a*300)},1500)}),document.getElementById("btn-fireworks").addEventListener("click",()=>{navigator.vibrate&&navigator.vibrate(50);for(let i=0;i<10;i++)M((Math.random()-.5)*30,(Math.random()-.5)*30,(Math.random()-.5)*20);setTimeout(()=>{t.classList.add("hidden"),t.classList.remove("active"),e.classList.remove("hidden"),e.classList.add("active")},3e3)}),document.getElementById("btn-seal").addEventListener("click",()=>{document.getElementById("wish-input").value.trim()&&(navigator.vibrate&&navigator.vibrate(50),e.classList.add("hidden"),e.classList.remove("active"),l.classList.remove("hidden"),l.classList.add("active"),setTimeout(()=>{const a="L5ez...MockBitcoinKey..."+Math.floor(Math.random()*1e4);document.getElementById("btc-key").innerText=a,M(0,0,0)},1e3))})}function R(){requestAnimationFrame(R);const n=Date.now()*.001;G.forEach((t,e)=>{t.position.z=t.userData.originalPos.z+Math.sin(n*2+t.position.x*.5)*1});for(let t=v.length-1;t>=0;t--){const e=v[t];e.userData.life-=.02,e.material.opacity=e.userData.life,e.position.add(e.userData.velocity),e.userData.velocity.y-=.01,e.userData.life<=0&&(o.remove(e),v.splice(t,1))}d.render(o,f)}function Z(){f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),d.setSize(window.innerWidth,window.innerHeight)}V();
