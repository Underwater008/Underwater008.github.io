import{S as G,C as O,W as k,P as q,V as W,O as z,A as j,D as H,G as U,b as V,c as E,T as M,B as I,M as Y,R as X,d as Z}from"./GLTFLoader-yLkTwuNX.js";import _ from"https://cdn.skypack.dev/lottie-web";const J="varying vec3 vPosition;varying vec2 vUv;uniform float iAudioData;uniform float iScale;uniform sampler2D iOriginalColor;void main(){vUv=uv;vec3 originalColor=texture(iOriginalColor,uv).rgb;float blackness=1.0-dot(originalColor,vec3(0.333));vec3 modifiedPosition=position;if(blackness>0.8){modifiedPosition.y+=iAudioData*blackness*iScale;}vPosition=modifiedPosition;gl_Position=projectionMatrix*modelViewMatrix*vec4(modifiedPosition,1.0);}",K="uniform float iTime;uniform vec2 iResolution;uniform float iSpeed;uniform float iGridSize;uniform float iFrequency;uniform float iBrightness;uniform float iTextScale;uniform sampler2D iChannel0;uniform sampler2D iChannel1;uniform sampler2D iOriginalColor;varying vec2 vUv;float text(vec2 fragCoord){vec2 uv=mod(fragCoord.xy,iGridSize)/iGridSize;vec2 block=fragCoord.xy/iGridSize;uv=uv*(iTextScale+1.0);uv+=floor(texture(iChannel1,block/iResolution+iTime*0.002).xy*iGridSize);uv*=0.0625;uv=clamp(uv,0.0,1.0);return texture(iChannel0,uv).r;}vec3 rain(vec2 fragCoord){fragCoord.x-=mod(fragCoord.x,iGridSize);float offset=sin(fragCoord.x*iFrequency);float speed=cos(fragCoord.x*6.0)*0.3+0.7;float y=fract(fragCoord.y/iResolution.y-iTime*speed*iSpeed+offset);return vec3(0.1,1.0,0.35)/(y*iBrightness);}void main(){vec2 fragCoord=vUv*iResolution;vec3 originalColor=texture(iOriginalColor,vUv).rgb;vec3 textRainEffect=text(fragCoord)*rain(fragCoord);vec3 finalColor=originalColor+textRainEffect;gl_FragColor=vec4(finalColor,1.0);}";let t,d,S,g,f,D,y,F,l,T;const a=[],N=1024,x=.01,Q=100,$=1,ee=0,oe=0,ie=.15,ne=.5,te=600;let n,R,v,u,c,B,s,ae;re();se();de();ce(4,.18);L();le();function re(){t=new G,t.background=new O(16777215),f=new k({antialias:!0}),f.setSize(window.innerWidth,window.innerHeight),document.getElementById("threeDScene").appendChild(f.domElement),d=new q(75,window.innerWidth/window.innerHeight,.1,1e3),d.position.y=2,d.lookAt(new W(0,0,0)),S=new z(d,f.domElement),g=.001,S.update(),D=new j(16777215,.5),t.add(D),y=new H(16777215,1),y.position.set(5,5,5),t.add(y),document.addEventListener("mousedown",ue,!1)}function se(){n=new Audio("./audios/The Chainsmokers - Roses (Audio) ft. ROZES (320).mp3"),v=new AudioContext,R=v.createMediaElementSource(n),u=v.createAnalyser(),R.connect(u),u.connect(v.destination),u.fftSize=256,B=u.frequencyBinCount,c=new Uint8Array(B),n.autoplay=!0,n.loop=!0,n.play()}function le(){let e=document.getElementById("lottie-container");s=_.loadAnimation({container:e,renderer:"svg",loop:!0,autoplay:!1,path:"./eRose/eroseAudioWave.json"}),s.addEventListener("DOMLoaded",function(){n.play(),s.play()}),e.addEventListener("click",function(){n.paused?(n.play(),s.play(),g=.001):(n.pause(),s.goToAndStop(0,!0))});function i(){requestAnimationFrame(i),n.paused?(s.pause(),g=0):s.isPaused&&s.play()}i()}function de(){F=new U,F.load("./3DModels/3dRose.glb",function(e){l=e.scene,T=l.children[0].material;const i=T.map;l.traverse(function(r){r.isMesh&&(r.material=new V({vertexShader:J,fragmentShader:K,uniforms:{iTime:{value:0},iSpeed:{value:.01},iResolution:{value:new E(window.innerWidth,window.innerHeight)},iGridSize:{value:8},iFrequency:{value:30},iBrightness:{value:5},iTextScale:{value:8},iChannel0:{value:new M().load("./images/rainCh1.png")},iChannel1:{value:new M().load("./images/rainCh2.png")},iOriginalColor:{value:i},iAudioData:{value:0},iScale:{value:.2}}}))}),l.scale.set(4,4,4),t.add(l),console.log("Model loaded successfully")},void 0,function(e){console.error("Error loading model:",e)})}function ce(e,i){const r=new I(i,i,i),m=new Y({color:0});let p=performance.now();function P(w,o){const A=(Math.random()-.5)*ne*2,h=new Z(r,m);if(h.position.set(0,w+A-.5,o-1.2),t.add(h),a.push(h),a.length>N){const C=a.shift();t.remove(C)}}function b(){requestAnimationFrame(b);const w=performance.now();if(u.getByteFrequencyData(c),w-p>=te){p=w;for(let o=0;o<c.length;o+=Math.floor(c.length/(e*e)))if(c[o]>Q){const h=o%e*i,C=Math.floor(o/e)*ie;P(h,C)}}a.forEach(o=>{o.position.x+=x*$,o.position.y+=x*ee,o.position.z+=x*oe});for(let o=a.length-1;o>=0;o--)(Math.abs(a[o].position.x)>10||Math.abs(a[o].position.y)>10||Math.abs(a[o].position.z)>10)&&(t.remove(a[o]),a.splice(o,1));f.render(t,d)}b()}function L(){requestAnimationFrame(L),S.update(),l&&(l.rotation.y+=g,l.traverse(function(e){if(e.isMesh&&e.material.uniforms){e.material.uniforms.iTime.value+=.05,u.getByteFrequencyData(c);const i=c.reduce((r,m)=>r+m)/c.length;e.material.uniforms.iAudioData.value=i/256}})),f.render(t,d)}window.addEventListener("resize",function(){d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight)});function ue(e){e.preventDefault();const i=new E;i.x=e.clientX/window.innerWidth*2-1,i.y=-(e.clientY/window.innerHeight)*2+1;const r=new X;r.setFromCamera(i,d);const m=r.intersectObjects(t.children,!0);if(m.length>0){const p=m[0].object;v.state==="suspended"&&v.resume().then(()=>{console.log("AudioContext resumed")}),(p.parent===l||p===ae)&&(n.paused?(n.play(),g=.001):(g=0,n.pause(),s.goToAndStop(0,!0)))}}
