import{S as L,C as B,W as O,P as k,V as q,O as z,A as W,D as H,G as U,b as j,c as R,T as b,B as V,M as Y,R as I,d as X}from"./GLTFLoader-yLkTwuNX.js";const Z="varying vec3 vPosition;varying vec2 vUv;uniform float iAudioData;uniform float iScale;uniform sampler2D iOriginalColor;void main(){vUv=uv;vec3 originalColor=texture(iOriginalColor,uv).rgb;float blackness=1.0-dot(originalColor,vec3(0.333));vec3 modifiedPosition=position;if(blackness>0.8){modifiedPosition.y+=iAudioData*blackness*iScale;}vPosition=modifiedPosition;gl_Position=projectionMatrix*modelViewMatrix*vec4(modifiedPosition,1.0);}",_="uniform float iTime;uniform vec2 iResolution;uniform float iSpeed;uniform float iGridSize;uniform float iFrequency;uniform float iBrightness;uniform float iTextScale;uniform sampler2D iChannel0;uniform sampler2D iChannel1;uniform sampler2D iOriginalColor;varying vec2 vUv;float text(vec2 fragCoord){vec2 uv=mod(fragCoord.xy,iGridSize)/iGridSize;vec2 block=fragCoord.xy/iGridSize;uv=uv*(iTextScale+1.0);uv+=floor(texture(iChannel1,block/iResolution+iTime*0.002).xy*iGridSize);uv*=0.0625;uv=clamp(uv,0.0,1.0);return texture(iChannel0,uv).r;}vec3 rain(vec2 fragCoord){fragCoord.x-=mod(fragCoord.x,iGridSize);float offset=sin(fragCoord.x*iFrequency);float speed=cos(fragCoord.x*6.0)*0.3+0.7;float y=fract(fragCoord.y/iResolution.y-iTime*speed*iSpeed+offset);return vec3(0.1,1.0,0.35)/(y*iBrightness);}void main(){vec2 fragCoord=vUv*iResolution;vec3 originalColor=texture(iOriginalColor,vUv).rgb;vec3 textRainEffect=text(fragCoord)*rain(fragCoord);vec3 finalColor=originalColor+textRainEffect;gl_FragColor=vec4(finalColor,1.0);}";let n,s,y,G,u,M,p,A,a,D;const t=[],J=1024,C=.01,K=100,N=1,Q=0,$=0,ee=.15,ie=.5,oe=600;let l,F,m,c,d,T;ne();te();re();ae(4,.18);P();function ne(){n=new L,n.background=new B(16777215),u=new O,u.setSize(window.innerWidth,window.innerHeight),document.getElementById("threeDScene").appendChild(u.domElement),s=new k(75,window.innerWidth/window.innerHeight,.1,1e3),s.position.y=2,s.lookAt(new q(0,0,0)),y=new z(s,u.domElement),G=.001,y.update(),M=new W(16777215,.5),n.add(M),p=new H(16777215,1),p.position.set(5,5,5),n.add(p),document.addEventListener("mousedown",se,!1)}function te(){l=new Audio("../audios/The Chainsmokers - Roses (Audio) ft. ROZES (320).mp3"),m=new AudioContext,F=m.createMediaElementSource(l),c=m.createAnalyser(),F.connect(c),c.connect(m.destination),c.fftSize=256,T=c.frequencyBinCount,d=new Uint8Array(T),l.autoplay=!0,l.loop=!0,l.play()}function re(){A=new U,A.load("../3DModels/3dRose.glb",function(i){a=i.scene,D=a.children[0].material;const o=D.map;a.traverse(function(r){r.isMesh&&(r.material=new j({vertexShader:Z,fragmentShader:_,uniforms:{iTime:{value:0},iSpeed:{value:.01},iResolution:{value:new R(window.innerWidth,window.innerHeight)},iGridSize:{value:8},iFrequency:{value:30},iBrightness:{value:5},iTextScale:{value:8},iChannel0:{value:new b().load("../images/rainCh1.png")},iChannel1:{value:new b().load("../images/rainCh2.png")},iOriginalColor:{value:o},iAudioData:{value:0},iScale:{value:.2}}}))}),a.scale.set(4,4,4),n.add(a),console.log("Model loaded successfully")},void 0,function(i){console.error("Error loading model:",i)})}function ae(i,o){const r=new V(o,o,o),f=new Y({color:0});let g=performance.now();function E(h,e){const S=(Math.random()-.5)*ie*2,v=new X(r,f);if(v.position.set(0,h+S-.5,e-1.2),n.add(v),t.push(v),t.length>J){const w=t.shift();n.remove(w)}}function x(){requestAnimationFrame(x);const h=performance.now();if(c.getByteFrequencyData(d),h-g>=oe){g=h;for(let e=0;e<d.length;e+=Math.floor(d.length/(i*i)))if(d[e]>K){const v=e%i*o,w=Math.floor(e/i)*ee;E(v,w)}}t.forEach(e=>{e.position.x+=C*N,e.position.y+=C*Q,e.position.z+=C*$});for(let e=t.length-1;e>=0;e--)(Math.abs(t[e].position.x)>10||Math.abs(t[e].position.y)>10||Math.abs(t[e].position.z)>10)&&(n.remove(t[e]),t.splice(e,1));u.render(n,s)}x()}function P(){requestAnimationFrame(P),y.update(),a&&(a.rotation.y+=G,a.traverse(function(i){if(i.isMesh&&i.material.uniforms){i.material.uniforms.iTime.value+=.05,c.getByteFrequencyData(d);const o=d.reduce((r,f)=>r+f)/d.length;i.material.uniforms.iAudioData.value=o/256}})),u.render(n,s)}window.addEventListener("resize",function(){s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)});function se(i){i.preventDefault();const o=new R;o.x=i.clientX/window.innerWidth*2-1,o.y=-(i.clientY/window.innerHeight)*2+1;const r=new I;r.setFromCamera(o,s);const f=r.intersectObjects(n.children,!0);if(f.length>0){const g=f[0].object;m.state==="suspended"&&m.resume().then(()=>{console.log("AudioContext resumed")}),g.parent===a&&(l.paused?l.play():l.pause())}}
